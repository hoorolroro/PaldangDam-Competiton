{"cells":[{"cell_type":"code","execution_count":null,"id":"be1312b6","metadata":{"id":"be1312b6"},"outputs":[],"source":["### 환경설정\n","\n","\n","## 1.기본\n","import numpy as np  # numpy 패키지 가져오기\n","import matplotlib.pyplot as plt # 시각화 패키지 가져오기\n","\n","## 2.데이터 가져오기\n","import pandas as pd # csv -> dataframe으로 전환\n","from sklearn import datasets # python 저장 데이터 가져오기\n","\n","## 4. 훈련/검증용 데이터 분리\n","from sklearn.model_selection import train_test_split \n","\n","## 5.분류모델구축\n","from sklearn.tree import DecisionTreeClassifier # 결정 트리\n","from sklearn.neighbors import KNeighborsClassifier # K-최근접 이웃\n","from sklearn.linear_model import LogisticRegression # 로지스틱 회귀 모델\n","from sklearn.linear_model import LinearRegression\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.ensemble import AdaBoostClassifier\n","\n","## 5_1.앙상블 모델 구축\n","from sklearn.ensemble import VotingClassifier # 과반수 투표(Majority Voting) \n","\n","## 6.모델검정\n","from sklearn.metrics import confusion_matrix, classification_report # 정오분류표\n","from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score # 정확도, 민감도 등\n","from sklearn.metrics import roc_curve, auc # ROC 곡선 그리기\n","from sklearn.metrics import mean_squared_error\n","from sklearn.metrics import r2_score\n","\n","## 7.최적화\n","from sklearn.model_selection import learning_curve, validation_curve # 학습곡선, 검증곡선\n","from sklearn.model_selection import GridSearchCV # 하이퍼파라미터 튜닝\n","from sklearn.model_selection import cross_val_score # 교차타당도 # 추가\n","\n","\n","## 8. 데이터 전처리\n","from sklearn.preprocessing import StandardScaler # 표준화\n","from sklearn.preprocessing import MinMaxScaler # 정규화\n","from sklearn.preprocessing import LabelEncoder # 문자형 변수를 숫자형 변수로 변경\n","from sklearn.preprocessing import OneHotEncoder\n","from sklearn.decomposition import PCA\n","\n","## 9. 데이터 시각화\n","import pandas as pd\n","import seaborn as sns\n","from scipy import stats # 확률분포 분석할때와 해당 그래프 그릴 경우 필요\n","import plotly.express as px \n","\n","## 10. 경고무시\n","import warnings\n","warnings.filterwarnings('ignore')\n","\n","## 11. Tensorflow\n","import tensorflow as tf\n","from tensorflow.keras import Sequential # Sequential 형태의 모델을 만들어줌\n","from tensorflow.keras import layers #Dense를 만들때 사용\n","from tensorflow.keras import activations # activation을 만들 때 사용\n","from tensorflow.keras.layers import Dense, Activation, Flatten, Input # 전부 다 불러오는 방법\n","from tensorflow.keras.utils import plot_model # 모델을 시각화\n","\n","# 12. 파일 불러오기\n","from glob import glob"]},{"cell_type":"code","execution_count":null,"id":"a8abda7d","metadata":{"id":"a8abda7d","outputId":"0396e622-0452-4e01-c063-107f42d549f8"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: xgboost in c:\\users\\playdata\\anaconda3\\lib\\site-packages (1.6.2)\n","Requirement already satisfied: scipy in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from xgboost) (1.7.3)\n","Requirement already satisfied: numpy in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from xgboost) (1.21.5)\n"]}],"source":["# xgboost 설치\n","!pip install xgboost"]},{"cell_type":"code","execution_count":null,"id":"a2e2ac17","metadata":{"scrolled":true,"id":"a2e2ac17","outputId":"fb30ed7e-6e91-40c7-995d-0accea845191"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: optuna in c:\\users\\playdata\\anaconda3\\lib\\site-packages (3.0.0)\n","Requirement already satisfied: cmaes>=0.8.2 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (0.8.2)\n","Requirement already satisfied: tqdm in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (4.64.0)\n","Requirement already satisfied: typing-extensions>=3.10.0.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (4.1.1)\n","Requirement already satisfied: PyYAML in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (6.0)\n","Requirement already satisfied: numpy in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (1.21.5)\n","Requirement already satisfied: colorlog in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (6.7.0)\n","Requirement already satisfied: packaging>=20.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (21.3)\n","Requirement already satisfied: scipy<1.9.0,>=1.7.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (1.7.3)\n","Requirement already satisfied: alembic in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (1.8.1)\n","Requirement already satisfied: cliff in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (4.0.0)\n","Requirement already satisfied: sqlalchemy>=1.1.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from optuna) (1.4.32)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from packaging>=20.0->optuna) (3.0.4)\n","Requirement already satisfied: greenlet!=0.4.17 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from sqlalchemy>=1.1.0->optuna) (1.1.1)\n","Requirement already satisfied: Mako in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from alembic->optuna) (1.2.2)\n","Requirement already satisfied: autopage>=0.4.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cliff->optuna) (0.5.1)\n","Requirement already satisfied: PrettyTable>=0.7.2 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cliff->optuna) (3.4.0)\n","Requirement already satisfied: stevedore>=2.0.1 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cliff->optuna) (4.0.0)\n","Requirement already satisfied: importlib-metadata>=4.4 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cliff->optuna) (4.11.3)\n","Requirement already satisfied: cmd2>=1.0.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cliff->optuna) (2.4.2)\n","Requirement already satisfied: colorama in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from colorlog->optuna) (0.4.4)\n","Requirement already satisfied: pyreadline3 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cmd2>=1.0.0->cliff->optuna) (3.4.1)\n","Requirement already satisfied: attrs>=16.3.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cmd2>=1.0.0->cliff->optuna) (21.4.0)\n","Requirement already satisfied: wcwidth>=0.1.7 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cmd2>=1.0.0->cliff->optuna) (0.2.5)\n","Requirement already satisfied: pyperclip>=1.6 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from cmd2>=1.0.0->cliff->optuna) (1.8.2)\n","Requirement already satisfied: zipp>=0.5 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from importlib-metadata>=4.4->cliff->optuna) (3.7.0)\n","Requirement already satisfied: pbr!=2.1.0,>=2.0.0 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from stevedore>=2.0.1->cliff->optuna) (5.10.0)\n","Requirement already satisfied: MarkupSafe>=0.9.2 in c:\\users\\playdata\\anaconda3\\lib\\site-packages (from Mako->alembic->optuna) (2.0.1)\n"]}],"source":["# optuna 설치\n","!pip install optuna"]},{"cell_type":"code","execution_count":null,"id":"fb8817e2","metadata":{"id":"fb8817e2"},"outputs":[],"source":["X_train_sample = pd.read_csv('X_train_sample.csv', encoding='cp949', index_col = 0)\n","X_test_sample = pd.read_csv('X_test_sample.csv', encoding='cp949', index_col = 0)\n","y_train_sample = pd.read_csv('y_train_sample.csv', encoding='cp949', index_col = 0)\n","y_test_sample = pd.read_csv('y_test_sample.csv', encoding='cp949', index_col = 0)"]},{"cell_type":"code","execution_count":null,"id":"e1d01eb9","metadata":{"id":"e1d01eb9","outputId":"13c3e8d9-3155-4d37-a172-b1c82f8fe582"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>팔당댐 유입량 (단위: m^3/s)</th>\n","      <th>총 방류량 (단위: m^3/s)</th>\n","      <th>대곡교 강수량</th>\n","      <th>진관교 강수량</th>\n","      <th>송정동 강수량</th>\n","      <th>대곡교 누적 강수량</th>\n","      <th>진관교 누적 강수량</th>\n","      <th>송정동 누적 강수량</th>\n","      <th>청담대교 유량 부호</th>\n","      <th>한강대교 유량 부호</th>\n","      <th>행주대교 유량 부호</th>\n","      <th>청담대교 유량_abs</th>\n","      <th>한강대교 유량_abs</th>\n","      <th>행주대교 유량_abs</th>\n","      <th>장마</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>555.0</td>\n","      <td>555.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>469.05</td>\n","      <td>729.80</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>464.6</td>\n","      <td>562.9</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>498.00</td>\n","      <td>731.48</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>478.1</td>\n","      <td>576.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>490.68</td>\n","      <td>726.42</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>464.8</td>\n","      <td>563.1</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>476.21</td>\n","      <td>726.42</td>\n","      <td>552.17</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>478.1</td>\n","      <td>576.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>476.21</td>\n","      <td>707.17</td>\n","      <td>564.29</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>247033</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>291.89</td>\n","      <td>376.45</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247034</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>275.45</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247035</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>258.79</td>\n","      <td>279.56</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247036</th>\n","      <td>83.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>287.78</td>\n","      <td>376.45</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247037</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>300.12</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>247038 rows × 15 columns</p>\n","</div>"],"text/plain":["        팔당댐 유입량 (단위: m^3/s)  총 방류량 (단위: m^3/s)  대곡교 강수량  진관교 강수량  송정동 강수량  \\\n","0                     555.0              555.0      0.0      0.0      0.0   \n","1                     464.6              562.9      0.0      0.0      0.0   \n","2                     478.1              576.4      0.0      0.0      0.0   \n","3                     464.8              563.1      0.0      0.0      0.0   \n","4                     478.1              576.4      0.0      0.0      0.0   \n","...                     ...                ...      ...      ...      ...   \n","247033                183.0              284.0      0.0      0.0      0.0   \n","247034                183.0              284.0      0.0      0.0      0.0   \n","247035                183.0              284.0      0.0      0.0      0.0   \n","247036                 83.0              284.0      0.0      0.0      0.0   \n","247037                183.0              284.0      0.0      0.0      0.0   \n","\n","        대곡교 누적 강수량  진관교 누적 강수량  송정동 누적 강수량  청담대교 유량 부호  한강대교 유량 부호  \\\n","0              0.0         0.0         0.0           1           1   \n","1              0.0         0.0         0.0           1           1   \n","2              0.0         0.0         0.0           1           1   \n","3              0.0         0.0         0.0           1           1   \n","4              0.0         0.0         0.0           1           1   \n","...            ...         ...         ...         ...         ...   \n","247033         0.0         0.0         0.0           1           1   \n","247034         0.0         0.0         0.0           1           1   \n","247035         0.0         0.0         0.0           1           1   \n","247036         0.0         0.0         0.0           1           1   \n","247037         0.0         0.0         0.0           1           1   \n","\n","        행주대교 유량 부호  청담대교 유량_abs  한강대교 유량_abs  행주대교 유량_abs  장마  \n","0                1       469.05       729.80       540.18   0  \n","1                1       498.00       731.48       540.18   0  \n","2                1       490.68       726.42       540.18   0  \n","3                1       476.21       726.42       552.17   0  \n","4                1       476.21       707.17       564.29   0  \n","...            ...          ...          ...          ...  ..  \n","247033           1       264.07       291.89       376.45   0  \n","247034           1       264.07       275.45       386.43   0  \n","247035           1       258.79       279.56       386.43   0  \n","247036           1       264.07       287.78       376.45   0  \n","247037           1       264.07       300.12       386.43   0  \n","\n","[247038 rows x 15 columns]"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["X_train_sample"]},{"cell_type":"code","execution_count":null,"id":"6d07be71","metadata":{"id":"6d07be71","outputId":"141d2206-66ad-4d43-c760-ff239427e1b2"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>팔당댐 유입량 (단위: m^3/s)</th>\n","      <th>총 방류량 (단위: m^3/s)</th>\n","      <th>대곡교 강수량</th>\n","      <th>진관교 강수량</th>\n","      <th>송정동 강수량</th>\n","      <th>대곡교 누적 강수량</th>\n","      <th>진관교 누적 강수량</th>\n","      <th>송정동 누적 강수량</th>\n","      <th>청담대교 유량 부호</th>\n","      <th>한강대교 유량 부호</th>\n","      <th>행주대교 유량 부호</th>\n","      <th>청담대교 유량_abs</th>\n","      <th>한강대교 유량_abs</th>\n","      <th>행주대교 유량_abs</th>\n","      <th>장마</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>247038</th>\n","      <td>277.00</td>\n","      <td>277.00</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>263.12</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247039</th>\n","      <td>173.00</td>\n","      <td>173.00</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>269.40</td>\n","      <td>287.78</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247040</th>\n","      <td>179.00</td>\n","      <td>179.00</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>269.40</td>\n","      <td>300.12</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247041</th>\n","      <td>178.00</td>\n","      <td>178.00</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>296.01</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247042</th>\n","      <td>379.00</td>\n","      <td>178.00</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>291.89</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>253006</th>\n","      <td>140.94</td>\n","      <td>140.94</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>285.72</td>\n","      <td>575.57</td>\n","      <td>493.58</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>253007</th>\n","      <td>141.07</td>\n","      <td>141.07</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>274.78</td>\n","      <td>501.04</td>\n","      <td>505.03</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>253008</th>\n","      <td>141.01</td>\n","      <td>141.01</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>269.40</td>\n","      <td>425.89</td>\n","      <td>505.03</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>253009</th>\n","      <td>755.75</td>\n","      <td>140.75</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>198.19</td>\n","      <td>493.58</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>253010</th>\n","      <td>140.56</td>\n","      <td>140.56</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>269.40</td>\n","      <td>70.09</td>\n","      <td>482.26</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5973 rows × 15 columns</p>\n","</div>"],"text/plain":["        팔당댐 유입량 (단위: m^3/s)  총 방류량 (단위: m^3/s)  대곡교 강수량  진관교 강수량  송정동 강수량  \\\n","247038               277.00             277.00      0.0      0.0      0.0   \n","247039               173.00             173.00      0.0      0.0      0.0   \n","247040               179.00             179.00      0.0      0.0      0.0   \n","247041               178.00             178.00      0.0      0.0      0.0   \n","247042               379.00             178.00      0.0      0.0      0.0   \n","...                     ...                ...      ...      ...      ...   \n","253006               140.94             140.94      0.0      0.0      0.0   \n","253007               141.07             141.07      0.0      0.0      0.0   \n","253008               141.01             141.01      0.0      0.0      0.0   \n","253009               755.75             140.75      0.0      0.0      0.0   \n","253010               140.56             140.56      0.0      0.0      0.0   \n","\n","        대곡교 누적 강수량  진관교 누적 강수량  송정동 누적 강수량  청담대교 유량 부호  한강대교 유량 부호  \\\n","247038         0.0         0.0         0.0           1           1   \n","247039         0.0         0.0         0.0           1           1   \n","247040         0.0         0.0         0.0           1           1   \n","247041         0.0         0.0         0.0           1           1   \n","247042         0.0         0.0         0.0           1           1   \n","...            ...         ...         ...         ...         ...   \n","253006         0.0         0.0         0.0           1           1   \n","253007         0.0         0.0         0.0           1           1   \n","253008         0.0         0.0         0.0           1           1   \n","253009         0.0         0.0         0.0           1           1   \n","253010         0.0         0.0         0.0           1           1   \n","\n","        행주대교 유량 부호  청담대교 유량_abs  한강대교 유량_abs  행주대교 유량_abs  장마  \n","247038           1       264.07       263.12       386.43   0  \n","247039           1       269.40       287.78       386.43   0  \n","247040           1       269.40       300.12       386.43   0  \n","247041           1       264.07       296.01       386.43   0  \n","247042           1       264.07       291.89       386.43   0  \n","...            ...          ...          ...          ...  ..  \n","253006           1       285.72       575.57       493.58   0  \n","253007           1       274.78       501.04       505.03   0  \n","253008           1       269.40       425.89       505.03   0  \n","253009           1       264.07       198.19       493.58   0  \n","253010           1       269.40        70.09       482.26   0  \n","\n","[5973 rows x 15 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["X_test_sample"]},{"cell_type":"code","execution_count":null,"id":"45252675","metadata":{"id":"45252675","outputId":"082786b8-dd82-4c9c-dee0-d47de8092af1"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>청담대교 수위 (단위: cm)</th>\n","      <th>잠수교 수위 (단위: cm)</th>\n","      <th>한강대교 수위 (단위: cm)</th>\n","      <th>행주대교 수위 (단위: cm)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>310.7</td>\n","      <td>300.2</td>\n","      <td>290.0</td>\n","      <td>275.3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>314.7</td>\n","      <td>300.2</td>\n","      <td>290.0</td>\n","      <td>275.3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>313.7</td>\n","      <td>301.2</td>\n","      <td>290.0</td>\n","      <td>275.3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>311.7</td>\n","      <td>301.2</td>\n","      <td>290.0</td>\n","      <td>276.3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>311.7</td>\n","      <td>301.2</td>\n","      <td>291.0</td>\n","      <td>277.3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>247033</th>\n","      <td>277.7</td>\n","      <td>266.2</td>\n","      <td>273.0</td>\n","      <td>260.3</td>\n","    </tr>\n","    <tr>\n","      <th>247034</th>\n","      <td>277.7</td>\n","      <td>266.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247035</th>\n","      <td>276.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247036</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>260.3</td>\n","    </tr>\n","    <tr>\n","      <th>247037</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>247038 rows × 4 columns</p>\n","</div>"],"text/plain":["        청담대교 수위 (단위: cm)  잠수교 수위 (단위: cm)  한강대교 수위 (단위: cm)  행주대교 수위 (단위: cm)\n","0                  310.7            300.2             290.0             275.3\n","1                  314.7            300.2             290.0             275.3\n","2                  313.7            301.2             290.0             275.3\n","3                  311.7            301.2             290.0             276.3\n","4                  311.7            301.2             291.0             277.3\n","...                  ...              ...               ...               ...\n","247033             277.7            266.2             273.0             260.3\n","247034             277.7            266.2             273.0             261.3\n","247035             276.7            267.2             273.0             261.3\n","247036             277.7            267.2             273.0             260.3\n","247037             277.7            267.2             273.0             261.3\n","\n","[247038 rows x 4 columns]"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["y_train_sample"]},{"cell_type":"code","execution_count":null,"id":"7c03a14d","metadata":{"scrolled":false,"id":"7c03a14d","outputId":"f9447319-d20e-4259-bfac-01c3b67625c4"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>청담대교 수위 (단위: cm)</th>\n","      <th>잠수교 수위 (단위: cm)</th>\n","      <th>한강대교 수위 (단위: cm)</th>\n","      <th>행주대교 수위 (단위: cm)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>247038</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247039</th>\n","      <td>278.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247040</th>\n","      <td>278.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247041</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247042</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>253006</th>\n","      <td>281.7</td>\n","      <td>281.2</td>\n","      <td>278.0</td>\n","      <td>271.3</td>\n","    </tr>\n","    <tr>\n","      <th>253007</th>\n","      <td>279.7</td>\n","      <td>279.2</td>\n","      <td>278.0</td>\n","      <td>272.3</td>\n","    </tr>\n","    <tr>\n","      <th>253008</th>\n","      <td>278.7</td>\n","      <td>277.2</td>\n","      <td>277.0</td>\n","      <td>272.3</td>\n","    </tr>\n","    <tr>\n","      <th>253009</th>\n","      <td>277.7</td>\n","      <td>276.2</td>\n","      <td>276.0</td>\n","      <td>271.3</td>\n","    </tr>\n","    <tr>\n","      <th>253010</th>\n","      <td>278.7</td>\n","      <td>276.2</td>\n","      <td>275.0</td>\n","      <td>270.3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5973 rows × 4 columns</p>\n","</div>"],"text/plain":["        청담대교 수위 (단위: cm)  잠수교 수위 (단위: cm)  한강대교 수위 (단위: cm)  행주대교 수위 (단위: cm)\n","247038             277.7            267.2             273.0             261.3\n","247039             278.7            267.2             273.0             261.3\n","247040             278.7            267.2             273.0             261.3\n","247041             277.7            267.2             273.0             261.3\n","247042             277.7            267.2             273.0             261.3\n","...                  ...              ...               ...               ...\n","253006             281.7            281.2             278.0             271.3\n","253007             279.7            279.2             278.0             272.3\n","253008             278.7            277.2             277.0             272.3\n","253009             277.7            276.2             276.0             271.3\n","253010             278.7            276.2             275.0             270.3\n","\n","[5973 rows x 4 columns]"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["y_test_sample"]},{"cell_type":"code","execution_count":null,"id":"135c0f78","metadata":{"id":"135c0f78"},"outputs":[],"source":["X_train_sample_index = X_train_sample.loc[:247036,:].reset_index(drop = True)\n","y_train_sample_index = y_train_sample.loc[1:,:].reset_index(drop = True)\n","\n","X_test_sample_index = X_test_sample.loc[:253009, :].reset_index(drop = True)\n","y_test_sample_index = y_test_sample.loc[247039:, ].reset_index(drop = True)"]},{"cell_type":"code","execution_count":null,"id":"b02fa779","metadata":{"id":"b02fa779","outputId":"7e1ca726-9484-46e6-ce38-a80220707a79"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>팔당댐 유입량 (단위: m^3/s)</th>\n","      <th>총 방류량 (단위: m^3/s)</th>\n","      <th>대곡교 강수량</th>\n","      <th>진관교 강수량</th>\n","      <th>송정동 강수량</th>\n","      <th>대곡교 누적 강수량</th>\n","      <th>진관교 누적 강수량</th>\n","      <th>송정동 누적 강수량</th>\n","      <th>청담대교 유량 부호</th>\n","      <th>한강대교 유량 부호</th>\n","      <th>행주대교 유량 부호</th>\n","      <th>청담대교 유량_abs</th>\n","      <th>한강대교 유량_abs</th>\n","      <th>행주대교 유량_abs</th>\n","      <th>장마</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>555.0</td>\n","      <td>555.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>469.05</td>\n","      <td>729.80</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>464.6</td>\n","      <td>562.9</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>498.00</td>\n","      <td>731.48</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>478.1</td>\n","      <td>576.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>490.68</td>\n","      <td>726.42</td>\n","      <td>540.18</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>464.8</td>\n","      <td>563.1</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>476.21</td>\n","      <td>726.42</td>\n","      <td>552.17</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>478.1</td>\n","      <td>576.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>476.21</td>\n","      <td>707.17</td>\n","      <td>564.29</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>247032</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>304.23</td>\n","      <td>376.45</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247033</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>291.89</td>\n","      <td>376.45</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247034</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>275.45</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247035</th>\n","      <td>183.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>258.79</td>\n","      <td>279.56</td>\n","      <td>386.43</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>247036</th>\n","      <td>83.0</td>\n","      <td>284.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>264.07</td>\n","      <td>287.78</td>\n","      <td>376.45</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>247037 rows × 15 columns</p>\n","</div>"],"text/plain":["        팔당댐 유입량 (단위: m^3/s)  총 방류량 (단위: m^3/s)  대곡교 강수량  진관교 강수량  송정동 강수량  \\\n","0                     555.0              555.0      0.0      0.0      0.0   \n","1                     464.6              562.9      0.0      0.0      0.0   \n","2                     478.1              576.4      0.0      0.0      0.0   \n","3                     464.8              563.1      0.0      0.0      0.0   \n","4                     478.1              576.4      0.0      0.0      0.0   \n","...                     ...                ...      ...      ...      ...   \n","247032                183.0              284.0      0.0      0.0      0.0   \n","247033                183.0              284.0      0.0      0.0      0.0   \n","247034                183.0              284.0      0.0      0.0      0.0   \n","247035                183.0              284.0      0.0      0.0      0.0   \n","247036                 83.0              284.0      0.0      0.0      0.0   \n","\n","        대곡교 누적 강수량  진관교 누적 강수량  송정동 누적 강수량  청담대교 유량 부호  한강대교 유량 부호  \\\n","0              0.0         0.0         0.0           1           1   \n","1              0.0         0.0         0.0           1           1   \n","2              0.0         0.0         0.0           1           1   \n","3              0.0         0.0         0.0           1           1   \n","4              0.0         0.0         0.0           1           1   \n","...            ...         ...         ...         ...         ...   \n","247032         0.0         0.0         0.0           1           1   \n","247033         0.0         0.0         0.0           1           1   \n","247034         0.0         0.0         0.0           1           1   \n","247035         0.0         0.0         0.0           1           1   \n","247036         0.0         0.0         0.0           1           1   \n","\n","        행주대교 유량 부호  청담대교 유량_abs  한강대교 유량_abs  행주대교 유량_abs  장마  \n","0                1       469.05       729.80       540.18   0  \n","1                1       498.00       731.48       540.18   0  \n","2                1       490.68       726.42       540.18   0  \n","3                1       476.21       726.42       552.17   0  \n","4                1       476.21       707.17       564.29   0  \n","...            ...          ...          ...          ...  ..  \n","247032           1       264.07       304.23       376.45   0  \n","247033           1       264.07       291.89       376.45   0  \n","247034           1       264.07       275.45       386.43   0  \n","247035           1       258.79       279.56       386.43   0  \n","247036           1       264.07       287.78       376.45   0  \n","\n","[247037 rows x 15 columns]"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["X_train_sample_index"]},{"cell_type":"code","execution_count":null,"id":"7d768afe","metadata":{"id":"7d768afe","outputId":"870e5338-9057-4d36-f621-87b7a0d56b7e"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>청담대교 수위 (단위: cm)</th>\n","      <th>잠수교 수위 (단위: cm)</th>\n","      <th>한강대교 수위 (단위: cm)</th>\n","      <th>행주대교 수위 (단위: cm)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>314.7</td>\n","      <td>300.2</td>\n","      <td>290.0</td>\n","      <td>275.3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>313.7</td>\n","      <td>301.2</td>\n","      <td>290.0</td>\n","      <td>275.3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>311.7</td>\n","      <td>301.2</td>\n","      <td>290.0</td>\n","      <td>276.3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>311.7</td>\n","      <td>301.2</td>\n","      <td>291.0</td>\n","      <td>277.3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>311.7</td>\n","      <td>301.2</td>\n","      <td>291.0</td>\n","      <td>277.3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>247032</th>\n","      <td>277.7</td>\n","      <td>266.2</td>\n","      <td>273.0</td>\n","      <td>260.3</td>\n","    </tr>\n","    <tr>\n","      <th>247033</th>\n","      <td>277.7</td>\n","      <td>266.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247034</th>\n","      <td>276.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","    <tr>\n","      <th>247035</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>260.3</td>\n","    </tr>\n","    <tr>\n","      <th>247036</th>\n","      <td>277.7</td>\n","      <td>267.2</td>\n","      <td>273.0</td>\n","      <td>261.3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>247037 rows × 4 columns</p>\n","</div>"],"text/plain":["        청담대교 수위 (단위: cm)  잠수교 수위 (단위: cm)  한강대교 수위 (단위: cm)  행주대교 수위 (단위: cm)\n","0                  314.7            300.2             290.0             275.3\n","1                  313.7            301.2             290.0             275.3\n","2                  311.7            301.2             290.0             276.3\n","3                  311.7            301.2             291.0             277.3\n","4                  311.7            301.2             291.0             277.3\n","...                  ...              ...               ...               ...\n","247032             277.7            266.2             273.0             260.3\n","247033             277.7            266.2             273.0             261.3\n","247034             276.7            267.2             273.0             261.3\n","247035             277.7            267.2             273.0             260.3\n","247036             277.7            267.2             273.0             261.3\n","\n","[247037 rows x 4 columns]"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["y_train_sample_index"]},{"cell_type":"code","execution_count":null,"id":"ce73f060","metadata":{"id":"ce73f060"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"67013c8a","metadata":{"id":"67013c8a"},"outputs":[],"source":["from optuna.samplers import TPESampler\n","import optuna\n","from xgboost import XGBRegressor\n","from xgboost import plot_importance\n","\n","def objective(trial):\n","    \n","    param = {\n","        'tree_method' : 'exact',\n","        'objective' : 'reg:squarederror',\n","        'lambda': trial.suggest_loguniform('lambda', 1e-3, 10.0),\n","        'alpha': trial.suggest_loguniform('alpha', 1e-3, 10.0),\n","        'gamma' : trial.suggest_loguniform('gamma', 1e-3, 10.0),\n","        'colsample_bytree': trial.suggest_float('colsample_bytree', 0.3, 1.0),\n","        'subsample': trial.suggest_float('subsample', 0.5, 1.0),\n","        'learning_rate': trial.suggest_uniform(\"learning_rate\", 0.00001, 1),\n","        'n_estimators': trial.suggest_int('n_estimators', 100, 3000),\n","        'max_depth': trial.suggest_int('max_depth',3, 15),\n","        'random_state': trial.suggest_categorical('random_state', [2022]),\n","        'min_child_weight': trial.suggest_int('min_child_weight', 1, 300)\n","    }\n","    model = XGBRegressor(**param)  \n","    \n","    model.fit(X_train_sample_index,y_train_sample_index,eval_set=[(X_test_sample_index,y_test_sample_index)],early_stopping_rounds=50,verbose=False)\n","    \n","    pred = model.predict(X_test_sample_index)\n","    \n","    rmse = mean_squared_error(y_test_sample_index, pred,squared=False)\n","    \n","    return rmse"]},{"cell_type":"code","execution_count":null,"id":"76f8149c","metadata":{"id":"76f8149c","outputId":"69d8fa90-401b-49ca-b449-cf3ebda14a09"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u001b[32m[I 2022-09-01 20:12:51,185]\u001b[0m A new study created in memory with name: no-name-5e0c14d9-66c3-4e67-9721-b58f246859e5\u001b[0m\n","\u001b[32m[I 2022-09-01 20:13:46,948]\u001b[0m Trial 0 finished with value: 4.132307834397587 and parameters: {'lambda': 0.1060809619486914, 'alpha': 0.5140118480905642, 'gamma': 4.46695558657611, 'colsample_bytree': 0.5592087656941143, 'subsample': 0.8687166824069275, 'learning_rate': 0.6559737284794043, 'n_estimators': 2569, 'max_depth': 10, 'random_state': 2022, 'min_child_weight': 77}. Best is trial 0 with value: 4.132307834397587.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:14:23,889]\u001b[0m Trial 1 finished with value: 4.14695500066132 and parameters: {'lambda': 1.9777148372860047, 'alpha': 0.013840501096745979, 'gamma': 0.11931357678997877, 'colsample_bytree': 0.6599708683977039, 'subsample': 0.9062840576534786, 'learning_rate': 0.7782197058101781, 'n_estimators': 659, 'max_depth': 6, 'random_state': 2022, 'min_child_weight': 170}. Best is trial 0 with value: 4.132307834397587.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:15:39,317]\u001b[0m Trial 2 finished with value: 3.811113411549956 and parameters: {'lambda': 0.10852698556909403, 'alpha': 3.359291258447916, 'gamma': 0.00177891602062886, 'colsample_bytree': 0.6957938774749826, 'subsample': 0.5264166266399679, 'learning_rate': 0.24147136935032795, 'n_estimators': 2625, 'max_depth': 7, 'random_state': 2022, 'min_child_weight': 274}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:16:28,694]\u001b[0m Trial 3 finished with value: 3.9693332154828807 and parameters: {'lambda': 0.04521146048253442, 'alpha': 0.4232561147603332, 'gamma': 0.00351241133614035, 'colsample_bytree': 0.8013315120465647, 'subsample': 0.804787057609998, 'learning_rate': 0.47555974283196245, 'n_estimators': 340, 'max_depth': 9, 'random_state': 2022, 'min_child_weight': 133}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:17:15,529]\u001b[0m Trial 4 finished with value: 4.038468885922102 and parameters: {'lambda': 3.017719445689883, 'alpha': 0.26169862710463043, 'gamma': 0.0014311289611178089, 'colsample_bytree': 0.5680337711111203, 'subsample': 0.7386731486168604, 'learning_rate': 0.9050545853446037, 'n_estimators': 2864, 'max_depth': 6, 'random_state': 2022, 'min_child_weight': 26}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:18:00,126]\u001b[0m Trial 5 finished with value: 3.9225831258041373 and parameters: {'lambda': 0.004706200392177163, 'alpha': 2.211253626281517, 'gamma': 0.05949233066681133, 'colsample_bytree': 0.8774169504743283, 'subsample': 0.9259818336143302, 'learning_rate': 0.7199404719732964, 'n_estimators': 2296, 'max_depth': 4, 'random_state': 2022, 'min_child_weight': 291}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:18:46,657]\u001b[0m Trial 6 finished with value: 4.109102124733948 and parameters: {'lambda': 0.01019043174781009, 'alpha': 0.004652054696591853, 'gamma': 0.02007894004600197, 'colsample_bytree': 0.5048632413831486, 'subsample': 0.5730514333341488, 'learning_rate': 0.9286461913931765, 'n_estimators': 720, 'max_depth': 8, 'random_state': 2022, 'min_child_weight': 120}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:19:38,205]\u001b[0m Trial 7 finished with value: 3.9021051140205536 and parameters: {'lambda': 4.438573309318346, 'alpha': 0.0017537658594489794, 'gamma': 0.27845973730640483, 'colsample_bytree': 0.8279730060078869, 'subsample': 0.9826788355590883, 'learning_rate': 0.45165621670360767, 'n_estimators': 122, 'max_depth': 8, 'random_state': 2022, 'min_child_weight': 197}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:20:47,551]\u001b[0m Trial 8 finished with value: 3.962961349476478 and parameters: {'lambda': 0.028280150960271023, 'alpha': 0.0012482452374920883, 'gamma': 0.7774563256337018, 'colsample_bytree': 0.5409326799343617, 'subsample': 0.7208725291140361, 'learning_rate': 0.5381673239439929, 'n_estimators': 1449, 'max_depth': 9, 'random_state': 2022, 'min_child_weight': 187}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:21:34,604]\u001b[0m Trial 9 finished with value: 3.9305140882274294 and parameters: {'lambda': 0.0175163374565378, 'alpha': 0.00562450508941658, 'gamma': 1.6423641560531275, 'colsample_bytree': 0.6310057248836878, 'subsample': 0.5257405400956451, 'learning_rate': 0.6161830134325799, 'n_estimators': 391, 'max_depth': 8, 'random_state': 2022, 'min_child_weight': 138}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:28:37,516]\u001b[0m Trial 10 finished with value: 4.040663325043259 and parameters: {'lambda': 0.0011325680418102567, 'alpha': 9.896652946697714, 'gamma': 0.007108777266363474, 'colsample_bytree': 0.33277345714699147, 'subsample': 0.6327911911580211, 'learning_rate': 0.15184851732387267, 'n_estimators': 1895, 'max_depth': 14, 'random_state': 2022, 'min_child_weight': 278}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:30:14,980]\u001b[0m Trial 11 finished with value: 3.876372489331561 and parameters: {'lambda': 0.5779378622752838, 'alpha': 0.04077880999755886, 'gamma': 0.28793414445178933, 'colsample_bytree': 0.803059384331151, 'subsample': 0.996223668328854, 'learning_rate': 0.22548502261928116, 'n_estimators': 1290, 'max_depth': 12, 'random_state': 2022, 'min_child_weight': 236}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 20:31:56,815]\u001b[0m Trial 12 finished with value: 3.848903672402394 and parameters: {'lambda': 0.4007813002624515, 'alpha': 0.03616861779810169, 'gamma': 0.022427855435293777, 'colsample_bytree': 0.9901657553388687, 'subsample': 0.6520431005657497, 'learning_rate': 0.165871626504688, 'n_estimators': 1366, 'max_depth': 12, 'random_state': 2022, 'min_child_weight': 237}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:02:21,172]\u001b[0m Trial 13 finished with value: 20.83554472197764 and parameters: {'lambda': 0.30349275381884594, 'alpha': 0.062324431863921496, 'gamma': 0.019307828734325922, 'colsample_bytree': 0.9654928544551684, 'subsample': 0.641444067861536, 'learning_rate': 0.001424639325300181, 'n_estimators': 1884, 'max_depth': 15, 'random_state': 2022, 'min_child_weight': 245}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:03:29,797]\u001b[0m Trial 14 finished with value: 3.871895665595269 and parameters: {'lambda': 0.2752910323951457, 'alpha': 2.0682523046951036, 'gamma': 0.0012950451656309659, 'colsample_bytree': 0.9908459749284104, 'subsample': 0.5163822246485317, 'learning_rate': 0.3281788723645921, 'n_estimators': 1018, 'max_depth': 12, 'random_state': 2022, 'min_child_weight': 234}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:17:27,162]\u001b[0m Trial 15 finished with value: 3.8770150377235364 and parameters: {'lambda': 0.911457089525509, 'alpha': 0.13734056110430085, 'gamma': 0.010393831655567072, 'colsample_bytree': 0.3886857303359719, 'subsample': 0.6394810446195729, 'learning_rate': 0.024929590662463752, 'n_estimators': 1877, 'max_depth': 12, 'random_state': 2022, 'min_child_weight': 295}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:19:11,652]\u001b[0m Trial 16 finished with value: 3.871102362712261 and parameters: {'lambda': 0.09319878904398796, 'alpha': 0.023561149082458297, 'gamma': 0.0034781785327555443, 'colsample_bytree': 0.7181735279675672, 'subsample': 0.5829336101251161, 'learning_rate': 0.304636171086102, 'n_estimators': 2503, 'max_depth': 5, 'random_state': 2022, 'min_child_weight': 258}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:20:46,726]\u001b[0m Trial 17 finished with value: 3.8252337186413605 and parameters: {'lambda': 0.12606827294816625, 'alpha': 8.940667901721309, 'gamma': 0.04105328326449498, 'colsample_bytree': 0.9096771717574497, 'subsample': 0.697831069445938, 'learning_rate': 0.14419399897005855, 'n_estimators': 1169, 'max_depth': 11, 'random_state': 2022, 'min_child_weight': 213}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:21:52,894]\u001b[0m Trial 18 finished with value: 3.8909530994812496 and parameters: {'lambda': 9.105967868427522, 'alpha': 8.447432926205131, 'gamma': 0.06809421197311151, 'colsample_bytree': 0.7325794015685605, 'subsample': 0.7993605653584256, 'learning_rate': 0.31713563429763525, 'n_estimators': 2903, 'max_depth': 3, 'random_state': 2022, 'min_child_weight': 206}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:24:00,563]\u001b[0m Trial 19 finished with value: 3.8459995343760944 and parameters: {'lambda': 0.06763231478669914, 'alpha': 2.8259219185207294, 'gamma': 8.123123949893746, 'colsample_bytree': 0.8903579402581133, 'subsample': 0.6781822265264829, 'learning_rate': 0.10890296489855708, 'n_estimators': 1066, 'max_depth': 10, 'random_state': 2022, 'min_child_weight': 100}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:25:36,397]\u001b[0m Trial 20 finished with value: 4.0067950949613556 and parameters: {'lambda': 0.15271529481490181, 'alpha': 1.256618664437356, 'gamma': 0.0027389685703121535, 'colsample_bytree': 0.46301857202059105, 'subsample': 0.5733112403022352, 'learning_rate': 0.40195141502207, 'n_estimators': 1708, 'max_depth': 6, 'random_state': 2022, 'min_child_weight': 212}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:28:14,567]\u001b[0m Trial 21 finished with value: 3.832559735499931 and parameters: {'lambda': 0.06430169563154432, 'alpha': 5.0530020346431925, 'gamma': 5.929931751301697, 'colsample_bytree': 0.8939660803827095, 'subsample': 0.6959824883121862, 'learning_rate': 0.1069175007057183, 'n_estimators': 1180, 'max_depth': 10, 'random_state': 2022, 'min_child_weight': 93}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:31:26,857]\u001b[0m Trial 22 finished with value: 3.870823607851189 and parameters: {'lambda': 0.006017148149534652, 'alpha': 4.707939710825441, 'gamma': 1.1907020281416139, 'colsample_bytree': 0.8934667872361894, 'subsample': 0.7997512271215121, 'learning_rate': 0.07557631929944408, 'n_estimators': 1046, 'max_depth': 11, 'random_state': 2022, 'min_child_weight': 45}. Best is trial 2 with value: 3.811113411549956.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:32:32,182]\u001b[0m Trial 23 finished with value: 3.7924374671265877 and parameters: {'lambda': 0.0362604771593885, 'alpha': 0.8315851859083278, 'gamma': 0.32197106842058165, 'colsample_bytree': 0.9269672634326022, 'subsample': 0.6944006411572814, 'learning_rate': 0.2042598604336185, 'n_estimators': 2095, 'max_depth': 7, 'random_state': 2022, 'min_child_weight': 161}. Best is trial 23 with value: 3.7924374671265877.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:33:55,090]\u001b[0m Trial 24 finished with value: 3.772495889244778 and parameters: {'lambda': 0.024810522061371548, 'alpha': 0.7913390490340249, 'gamma': 0.22438866569340354, 'colsample_bytree': 0.7613673140368082, 'subsample': 0.7655052520489503, 'learning_rate': 0.22890594716683071, 'n_estimators': 2165, 'max_depth': 7, 'random_state': 2022, 'min_child_weight': 165}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:34:32,059]\u001b[0m Trial 25 finished with value: 3.8380225239574974 and parameters: {'lambda': 0.017249364857551543, 'alpha': 0.9821421426568836, 'gamma': 0.2819158742400343, 'colsample_bytree': 0.7371861444450541, 'subsample': 0.7739257009272902, 'learning_rate': 0.2929163580878479, 'n_estimators': 2237, 'max_depth': 7, 'random_state': 2022, 'min_child_weight': 158}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:35:18,577]\u001b[0m Trial 26 finished with value: 3.830730230893018 and parameters: {'lambda': 0.0024591678802004637, 'alpha': 0.9581651242646688, 'gamma': 0.1309942357196904, 'colsample_bytree': 0.648629259379979, 'subsample': 0.8484717241103787, 'learning_rate': 0.23079070011824177, 'n_estimators': 2147, 'max_depth': 7, 'random_state': 2022, 'min_child_weight': 181}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:36:49,069]\u001b[0m Trial 27 finished with value: 3.8110073724163476 and parameters: {'lambda': 0.03757428078469584, 'alpha': 0.18684063466583983, 'gamma': 0.5821866775406831, 'colsample_bytree': 0.7760931571405479, 'subsample': 0.7565133497871089, 'learning_rate': 0.37010558190853166, 'n_estimators': 2640, 'max_depth': 4, 'random_state': 2022, 'min_child_weight': 153}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:37:54,852]\u001b[0m Trial 28 finished with value: 3.8531951324862845 and parameters: {'lambda': 0.027392119535917293, 'alpha': 0.2048253635729621, 'gamma': 0.6603815848234097, 'colsample_bytree': 0.7682718574977121, 'subsample': 0.7610418458197975, 'learning_rate': 0.37896259445840785, 'n_estimators': 2058, 'max_depth': 3, 'random_state': 2022, 'min_child_weight': 146}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n","\u001b[32m[I 2022-09-01 21:38:36,082]\u001b[0m Trial 29 finished with value: 3.8714283513040977 and parameters: {'lambda': 0.008503151200888747, 'alpha': 0.3822892830493668, 'gamma': 3.4467115366745906, 'colsample_bytree': 0.8389826561179026, 'subsample': 0.8453687671753647, 'learning_rate': 0.5550632238231117, 'n_estimators': 2457, 'max_depth': 4, 'random_state': 2022, 'min_child_weight': 66}. Best is trial 24 with value: 3.772495889244778.\u001b[0m\n"]}],"source":["study = optuna.create_study(direction='minimize', sampler=TPESampler())\n","study.optimize(objective, n_trials=30)"]},{"cell_type":"markdown","id":"6cfc68d1","metadata":{"id":"6cfc68d1"},"source":["    4) subsample. 하나의 트리를 만들 때 사용할 데이터의 비율을 나타냅니다. 0.0 ~ 1.0 사이의 값을 넣으면 지정한 비율만큼만 랜덤하게 데이터를 사용합니다.\n","    5) colsample_bytree. 하나의 트리를 만들 때 사용할 feature의 비율을 나타냅니다. 0.0 ~ 1.0 사이의 값을 넣으면 트리를 만들 때 지정한 비율만큼만 랜덤하게 feature를 사용합니다.\n","    6) lambda : 과적합을 방지하기 위해서 정규화 정도를 의미한다. (높을수록 정규분포)\n","    7) alpha : 과적합을 방지하기 위해서 규제정도를 의미한다.\n","        -> 알파값이 증가할 수록 각 파라미터가 낮아져 곡선의 복잡성이 낮아져 오버피팅이 줄어듦\n","    8) gamma : 과적합을 방지하기 위한 파라미터\n","        -> gamma가 크면 decision boundary에서 멀리 있는 포인트는 영향이 없어지므로 선과 가까이 있는 포인트 하나하나의 영향이 상대적으로              크기 때문에 decision boundary가 곡선의 형태를 가짐. (reach가 짧음)\n","        -> gamma가 작으면 decision boundary는 직선의 형태를 가짐, 가까이 있는 포인트 하나하나가 decision boundary에 주는 영향이 상대적으로             작음"]},{"cell_type":"code","execution_count":null,"id":"5b41c4eb","metadata":{"id":"5b41c4eb","outputId":"feee8a4b-f8e5-4e2a-f60f-8e6412875aa9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Number of finished trials: 50\n","Best trial: {'lambda': 6.42624959349907, 'alpha': 3.698153718736625, 'gamma': 0.010761744241057256, 'colsample_bytree': 0.9568847274563008, 'subsample': 0.9028949888156346, 'learning_rate': 0.2373366639379164, 'n_estimators': 2145, 'max_depth': 3, 'random_state': 2022, 'min_child_weight': 11}\n"]}],"source":["print('Number of finished trials:', len(study.trials))\n","print('Best trial:', study.best_trial.params)"]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.12"},"colab":{"provenance":[],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":5}